let query="",category="",rssCacheList,tmpRssList={rssList:[],query:"",category:""};const fetchOptions={method:"GET",headers:{"Content-type":"application/x-www-form-urlencoded"}},resetTmpRssList=()=>{tmpRssList.rssList=[],tmpRssList.category="",tmpRssList.query=""},sortList=t=>{let e=tmpRssList.rssList;switch(e=e.length>0?tmpRssList.rssList:rssCacheList,t){case"1":return e.sort((t,e)=>new Date(e.date)-new Date(t.date));case"2":return e.sort((t,e)=>t.title.localeCompare(e.title));case"3":return e.sort((t,e)=>e.title.localeCompare(t.title));case"4":return e.sort((t,e)=>t.description.localeCompare(e.description));case"5":return e.sort((t,e)=>e.description.localeCompare(t.description));case"6":return e.sort((t,e)=>new Date(t.date)-new Date(e.date));default:return}},sortBy=()=>{let t=document.getElementById("sortSelect").value;try{tmpRssList.rssList=sortList(t),feedPagination()}catch(e){console.error(e)}},updateContainer=async(t,e)=>{t.ok?document.getElementById(e).innerHTML=await t.text():(console.error(`Error ${t.status}`),document.getElementById("container").innerHTML=`<h1 align='center'>ERROR ${t.status}</h1>`)},searchQuery=()=>{try{if(query=document.getElementById("searchBox").value.toLowerCase(),category="",tmpRssList.category=category,""!==query&&query===tmpRssList.query){feedPagination();return}let t=[];tmpRssList.query=query;let e=query.split(" ");rssCacheList.forEach(s=>{let r=s.categories.toLowerCase(),a=s.description.toLowerCase(),i=s.title.toLowerCase(),o=e.some(t=>r.includes(t)||a.includes(t)||i.includes(t));o&&t.push(s)}),t.length>0&&(tmpRssList.rssList=t,sortBy())}catch(s){console.error(s)}},searchCategory=t=>{try{if(query="",tmpRssList.query=query,category=t.toLowerCase(),""!==category&&category===tmpRssList.category){feedPagination();return}let e=[];tmpRssList.category=category,rssCacheList.forEach(t=>{t.categories.toLowerCase()===category&&e.push(t)}),e.length>0&&(tmpRssList.rssList=e,sortBy())}catch(s){console.error(s)}},getCategories=async()=>{try{let t=await fetch("router/router.php?src=categories",fetchOptions);await updateContainer(t,"link-categories")}catch(e){console.error(e)}},getRssList=async()=>{try{if(resetTmpRssList(),Array.isArray(rssCacheList)&&rssCacheList.length>0){getCategories(),feedPagination();return}let t=await fetch("router/router.php?src=reader",fetchOptions);rssCacheList=await t.json(),Array.isArray(rssCacheList)&&rssCacheList.length>0&&(getCategories(),feedPagination())}catch(e){console.error(e)}},updateRssList=async()=>{try{resetTmpRssList();let t=await fetch("router/router.php?src=update",fetchOptions);rssCacheList=await t.json(),Array.isArray(rssCacheList)&&rssCacheList.length>0&&(getCategories(),feedPagination())}catch(e){console.error(e)}};